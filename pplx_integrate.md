# Architecture Diagram
```
┌─────────────────────────────────────────────────────────────┐
│                     User Model Layer                        │
│                  (DeepSeekV2MoE, Llama4MoE, etc.)           │
└─────────────────────────┬───────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                    get_moe_impl_class()                     │
│            Selects: FusedMoE / EPMoE / DeepEPMoE / PPLXMoE  │
└─────────────────────────┬───────────────────────────────────┘
                          │
         ┌────────────────┼────────────────┐
         ▼                ▼                ▼
    ┌─────────┐     ┌──────────┐     ┌──────────┐
    │ DeepEP  │     │  PPLX    │     │   None   │
    │ Backend │     │ Backend  │     │ (Local)  │
    └────┬────┘     └────┬─────┘     └────┬─────┘
         │               │                │
         ▼               ▼                ▼
    ┌─────────────────────────────────────────┐
    │           sgl_kernel (C++/CUDA)         │
    │  • all-to-all ops  • grouped GEMM       │
    │  • dispatch/combine • quantization      │
    └─────────────────────────────────────────┘
```
